<?php
/**
 * @author  Ikaros Kappler
 * @date    2016-11-30
 * @version 1.0.0
 **/

require_once( "../database/bootstrap/autoload.php" );

header( 'Content-Type: text/json; charset=utf-8' );

//use Illuminate\Database\Eloquent\Model;
//$notes = Note::all();
//print_r( $notes );

if( !array_key_exists('note',$_GET) ) {
    header( 'HTTP/1.1 400 Bad Request' );
    echo json_encode( array( 'message' => "Param 'note' is missing." ) );
    die();
}

$note = $_GET['note'];

if( strlen($note) > 140 ) {
    header( 'HTTP/1.1 400 Bad Request' );
    echo json_encode( array( 'message' => "Param 'note' is too long." ) );
    die();
}

$node = new Note( array( 'data' => $note ) );
$node->save();


echo json_encode( array( "message" => "Note stored (" . strlen($note) . " bytes)." ) );


?>